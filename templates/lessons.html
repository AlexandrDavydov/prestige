{% extends "base.html" %}
{% block title %}–ó–∞–Ω—è—Ç–∏—è{% endblock %}
{% block content %}
<h1>–ó–∞–Ω—è—Ç–∏—è</h1>
<a href="{{ url_for('add_lesson') }}">‚ûï –î–æ–±–∞–≤–∏—Ç—å –∑–∞–Ω—è—Ç–∏–µ</a>

<form method="get" action="{{ url_for('lessons') }}">
    <label for="status_filter">–§–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É:</label>
    <select name="status_filter" id="status_filter" onchange="this.form.submit()">
        <option value="–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ" {% if status_filter=='–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ' %}selected{% endif %}>–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ</option>
        <option value="–°–æ—Å—Ç–æ—è–ª–æ—Å—å" {% if status_filter=='–°–æ—Å—Ç–æ—è–ª–æ—Å—å' %}selected{% endif %}>–°–æ—Å—Ç–æ—è–ª–æ—Å—å</option>
        <option value="–í—Å–µ" {% if status_filter=='–í—Å–µ' %}selected{% endif %}>–í—Å–µ</option>
    </select>
</form>

<table border="1">
<tr>
  <th>ID</th>
  <th>–î–∞—Ç–∞</th>
  <th>–¢—Ä–µ–Ω–µ—Ä</th>
  <th>–£—á–µ–Ω–∏–∫–∏</th>
  <th>–°—Ç–∞—Ç—É—Å</th>
</tr>

{% for l in lessons %}
<tr>
  <td>{{ l.id }}</td>
  <td>{{ l.date | ru_date }}</td>
  <td>
    {% for c in coaches %}
      {% if c.id == l.coach_id %}
        {{ c.last_name }} {{ c.first_name }}
      {% endif %}
    {% endfor %}
  </td>
<td>
  {% set ids = l.student_ids.split(',') %}
  {% for s in students %}
    {% if s.id|string in ids %}
      {{ s.last_name }} {{ s.first_name }}<br>
    {% endif %}
  {% endfor %}
</td>
  <td>{{ l.status }}</td>
  <td>
    <a href="{{ url_for('lesson_done', lesson_id=l.id) }}" title="–°–æ—Å—Ç–æ—è–ª–æ—Å—å">‚úÖ</a>
    <a href="{{ url_for('edit_lesson', lesson_id=l.id) }}" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">‚úèÔ∏è</a>
    <a href="{{ url_for('delete_lesson', lesson_id=l.id) }}" title="–£–¥–∞–ª–∏—Ç—å">üóëÔ∏è</a>
  </td>
</tr>
{% endfor %}
</table>

–®–∞–±–ª–æ–Ω—ã:
<select id="lesson_template_select">
    {% for l in lesson_templates %}
        <option value="{{ l.id }}">{{ l.template_name }}</option>
    {% endfor %}
</select>

<a href="#" class="btn" onclick="addFromTemplate()">üìã –î–æ–±–∞–≤–∏—Ç—å –∏–∑ —à–∞–±–ª–æ–Ω–∞</a>
<br>
<br>
<a href="{{ url_for('index') }}">‚¨Ö –ì–ª–∞–≤–Ω–∞—è</a>
<script>
function addFromTemplate() {
    const select = document.getElementById("lesson_template_select");
    const id = select.value;
    window.location.href = `/lesson_template/add/${id}`;
}
</script>
{% endblock %}

